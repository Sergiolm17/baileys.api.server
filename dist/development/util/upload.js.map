{"version":3,"file":"upload.js","names":["storage","multer","diskStorage","destination","req","file","callback","fs","existsSync","path","join","config","sessionDirectory","params","session","mkdirSync","recursive","filename","Date","now","originalname","uploadUtil"],"sources":["../../../node/util/upload.js"],"sourcesContent":["import path from 'path';\nimport multer from 'multer';\nimport fs from 'fs';\nimport config from '../config';\n\nconst storage = multer.diskStorage({\n  destination: function (req, file, callback) {\n    if (!fs.existsSync(path.join(config.sessionDirectory, req.params.session, 'uploads'))) {\n      fs.mkdirSync(path.join(config.sessionDirectory, req.params.session, 'uploads'), {\n        recursive: true,\n      });\n    }\n    callback(null, path.join(config.sessionDirectory, req.params.session, 'uploads'));\n  },\n  filename: function (req, file, callback) {\n    let filename = `${Date.now()}-${file.originalname}`;\n    callback(null, filename);\n  },\n});\n\nconst uploadUtil = multer({ storage: storage });\nexport default uploadUtil;\n"],"mappings":"yLAAA;AACA;AACA;AACA;;AAEA,MAAMA,OAAO,GAAGC,eAAA,CAAOC,WAAP,CAAmB;EACjCC,WAAW,EAAE,UAAUC,GAAV,EAAeC,IAAf,EAAqBC,QAArB,EAA+B;IAC1C,IAAI,CAACC,WAAA,CAAGC,UAAH,CAAcC,aAAA,CAAKC,IAAL,CAAUC,eAAA,CAAOC,gBAAjB,EAAmCR,GAAG,CAACS,MAAJ,CAAWC,OAA9C,EAAuD,SAAvD,CAAd,CAAL,EAAuF;MACrFP,WAAA,CAAGQ,SAAH,CAAaN,aAAA,CAAKC,IAAL,CAAUC,eAAA,CAAOC,gBAAjB,EAAmCR,GAAG,CAACS,MAAJ,CAAWC,OAA9C,EAAuD,SAAvD,CAAb,EAAgF;QAC9EE,SAAS,EAAE,IADmE,EAAhF;;IAGD;IACDV,QAAQ,CAAC,IAAD,EAAOG,aAAA,CAAKC,IAAL,CAAUC,eAAA,CAAOC,gBAAjB,EAAmCR,GAAG,CAACS,MAAJ,CAAWC,OAA9C,EAAuD,SAAvD,CAAP,CAAR;EACD,CARgC;EASjCG,QAAQ,EAAE,UAAUb,GAAV,EAAeC,IAAf,EAAqBC,QAArB,EAA+B;IACvC,IAAIW,QAAQ,GAAI,GAAEC,IAAI,CAACC,GAAL,EAAW,IAAGd,IAAI,CAACe,YAAa,EAAlD;IACAd,QAAQ,CAAC,IAAD,EAAOW,QAAP,CAAR;EACD,CAZgC,EAAnB,CAAhB;;;AAeA,MAAMI,UAAU,GAAG,IAAApB,eAAA,EAAO,EAAED,OAAO,EAAEA,OAAX,EAAP,CAAnB,C;AACeqB,U"}