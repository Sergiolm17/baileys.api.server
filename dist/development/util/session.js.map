{"version":3,"file":"session.js","names":["SessionUtil","getClient","session","client","clientsArray","status","syncConfig","req","config","fs","existsSync","path","join","sessionDirectory","JSON","parse","readFileSync","Object","assign","writeFileSync","stringify","downloadMediaMessage","message","type","messageType","keys","extension","mime","mimetype","key","id","buffer","logger","reuploadRequest","updateMediaMessage","writeFileWait","data","Promise","resolve","reject","writeFile","error","mkdirSync","recursive","createSession","res","sendUnread","body","state","saveCreds","useMultiFileAuthState","version","isLatest","fetchLatestBaileysVersion","info","sockect","makeWASocket","child","printQRInTerminal","auth","msgRetryCounterMap","browser","Browsers","macOS","browserName","store","makeInMemoryStore","readFromFile","e","rmSync","setInterval","writeToFile","bind","ev","on","_","connection","lastDisconnect","qr","callWebHook","output","statusCode","DisconnectReason","loggedOut","undefined","qrcode","messages","fromMe","includes","mediaAutoDownload","Number","fileLength"],"sources":["../../../node/util/session.js"],"sourcesContent":["import makeWASocket, { Browsers, DisconnectReason, downloadContentFromMessage, downloadMediaMessage, fetchLatestBaileysVersion, makeInMemoryStore, useMultiFileAuthState } from '@adiwajshing/baileys';\nimport { clientsArray } from './variable';\nimport path from 'path';\nimport { callWebHook, sendUnread } from './functions';\nimport fs from 'fs';\nimport * as mime from 'mime-types';\nimport { logger } from './logger';\n\nexport default class SessionUtil {\n  getClient(session) {\n    let client = clientsArray[session];\n    if (!client) {\n      client = clientsArray[session] = { status: null, session: session };\n    }\n    return client;\n  }\n  async syncConfig(req, session, client) {\n    const config = fs.existsSync(path.join(req.config.sessionDirectory, session, 'config.json')) ? JSON.parse(fs.readFileSync(path.join(req.config.sessionDirectory, session, 'config.json'))) : {};\n    Object.assign(config, client.config);\n    Object.assign(config, { status: client.status });\n    fs.writeFileSync(path.join(req.config.sessionDirectory, session, 'config.json'), JSON.stringify(config));\n  }\n  async downloadMediaMessage(req, session, message, type) {\n    const messageType = Object.keys(message.message)[0];\n    const extension = mime.extension(message.message[messageType].mimetype);\n    if (fs.existsSync(path.join(req.config.sessionDirectory, session, messageType, `${message.key.id}.${extension}`))) {\n      return path.join(req.config.sessionDirectory, session, messageType, `${message.key.id}.${extension}`);\n    }\n    const buffer = await downloadMediaMessage(\n      message,\n      type,\n      {},\n      {\n        logger: req.logger,\n        reuploadRequest: req.client.updateMediaMessage,\n      },\n    );\n    const writeFileWait = (path, data) => {\n      return new Promise((resolve, reject) => {\n        fs.writeFile(path, data, error => {\n          if (error) reject(error);\n          else resolve(path);\n        });\n      });\n    };\n    if (!fs.existsSync(path.join(req.config.sessionDirectory, session, messageType))) {\n      fs.mkdirSync(path.join(req.config.sessionDirectory, session, messageType), { recursive: true });\n    }\n    return await writeFileWait(path.join(req.config.sessionDirectory, session, messageType, `${message.key.id}.${extension}`), buffer);\n  }\n  async createSession(req, clientsArray, session, res) {\n    let client = this.getClient(session);\n    if (client.status != null && client.status !== 'close') {\n      await sendUnread(client, req);\n      return;\n    }\n    Object.assign(client, { status: 'initializing', config: req.body });\n    const { state, saveCreds } = await useMultiFileAuthState(path.join(req.config.sessionDirectory, session));\n    const { version, isLatest } = await fetchLatestBaileysVersion();\n    logger.info(`Using WhatsApp v${version.join('.')}${isLatest ? ', lates version' : ''}`);\n    let sockect = makeWASocket({\n      version,\n      logger: req.logger.child({}),\n      printQRInTerminal: client.config.printQRInTerminal ? client.config.printQRInTerminal : req.config.printQRInTerminal,\n      auth: state,\n      msgRetryCounterMap: {},\n      browser: Browsers.macOS(req.config.browserName),\n    });\n    const store = makeInMemoryStore({ logger: req.logger });\n    try {\n      store.readFromFile(path.join(req.config.sessionDirectory, session, 'store.json'));\n    } catch (e) {\n      fs.rmSync(path.join(req.config.sessionDirectory, session, 'store.json'));\n    }\n    setInterval(() => {\n      try {\n        store.writeToFile(path.join(req.config.sessionDirectory, session, 'store.json'));\n      } catch (e) {}\n    }, 10000);\n    client = clientsArray[session] = Object.assign(sockect, { ...client, store: store });\n    store.bind(sockect.ev);\n    sockect.ev.on('creds.update', saveCreds);\n    sockect.ev.on('connection.update', async (data, _) => {\n      const { connection, lastDisconnect, qr } = data;\n      if (connection === 'connecting') {\n        Object.assign(client, { status: 'connecting' });\n        await this.syncConfig(req, session, client);\n        callWebHook(client, req, `connection.${connection}`, {\n          data: data,\n        });\n        return;\n      }\n      if (connection === 'close') {\n        if (lastDisconnect.error?.output?.statusCode !== DisconnectReason.loggedOut) {\n          Object.assign(client, { status: 'close' });\n          await this.createSession(req, clientsArray, session, res);\n        } else {\n          Object.assign(client, { status: 'close' });\n          clientsArray[session] = undefined;\n          callWebHook(client, req, `connection.${connection}`, {\n            data: data,\n          });\n          fs.rmSync(path.join(req.config.sessionDirectory, session), { recursive: true });\n        }\n      }\n      if (connection === 'open') {\n        Object.assign(client, { status: 'open' });\n        await this.syncConfig(req, session, client);\n        callWebHook(client, req, `connection.${connection}`, {\n          data: data,\n        });\n        await sendUnread(client, req);\n      }\n      if (connection) {\n        if (connection !== 'close') {\n          callWebHook(client, req, `connection.${connection}`, {\n            data: data,\n          });\n        }\n      }\n      if (qr) {\n        Object.assign(client, { status: 'qrcode', qrcode: qr });\n        await this.syncConfig(req, session, client);\n        callWebHook(client, req, 'connection.qrcode', {\n          data: data,\n        });\n      }\n    });\n    sockect.ev.on('call', (data, _) => {\n      callWebHook(client, req, 'call', {\n        data: data,\n      });\n    });\n    sockect.ev.on('chats.set', (data, _) => {\n      callWebHook(client, req, 'chats.set', {\n        data: data,\n      });\n    });\n    sockect.ev.on('chats.upsert', (data, _) => {\n      callWebHook(client, req, 'chats.upsert', {\n        data: data,\n      });\n    });\n    sockect.ev.on('chats.update', (data, _) => {\n      callWebHook(client, req, 'chats.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('chats.delete', (data, _) => {\n      callWebHook(client, req, 'chats.delete', {\n        data: data,\n      });\n    });\n    sockect.ev.on('contacts.set', (data, _) => {\n      callWebHook(client, req, 'contacts.set', {\n        data: data,\n      });\n    });\n    sockect.ev.on('contacts.upsert', (data, _) => {\n      callWebHook(client, req, 'contacts.upsert', {\n        data: data,\n      });\n    });\n    sockect.ev.on('messages.set', (data, _) => {\n      callWebHook(client, req, 'messages.set', {\n        data: data,\n      });\n    });\n    sockect.ev.on('messages.upsert', async (data, _) => {\n      callWebHook(client, req, 'messages.upsert', {\n        data: data,\n      });\n      const messageType = data.messages[0].message ? (data.messages[0].key.fromMe ? false : Object.keys(data.messages[0].message)[0]) : false;\n      if (['stickerMessage', 'imageMessage', 'videoMessage', 'audioMessage', 'documentMessage'].includes(messageType) && req.config.mediaAutoDownload) {\n        if (Number(data.messages[0].message[messageType].fileLength) < 10485760) {\n          if (messageType === 'stickerMessage') {\n            await this.downloadMediaMessage(req, session, data.messages[0], 'buffer');\n          }\n          if (messageType === 'imageMessage') {\n            await this.downloadMediaMessage(req, session, data.messages[0], 'buffer');\n          }\n          if (messageType === 'videoMessage') {\n            await this.downloadMediaMessage(req, session, data.messages[0], 'buffer');\n          }\n          if (messageType === 'audioMessage') {\n            await this.downloadMediaMessage(req, session, data.messages[0], 'buffer');\n          }\n          if (messageType === 'documentMessage') {\n            await this.downloadMediaMessage(req, session, data.messages[0], 'buffer');\n          }\n        }\n      }\n    });\n    sockect.ev.on('messages.update', (data, _) => {\n      callWebHook(client, req, 'messages.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('message-info.update', (data, _) => {\n      callWebHook(client, req, 'messages.info.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('message-receipt.update', (data, _) => {\n      callWebHook(client, req, 'messages.receipt.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('messages.delete', (data, _) => {\n      callWebHook(client, req, 'messages.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('contacts.update', (data, _) => {\n      callWebHook(client, req, 'messages.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('groups.update', (data, _) => {\n      callWebHook(client, req, 'messages.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('group-participants.update', (data, _) => {\n      callWebHook(client, req, 'messages.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('blocklist.set', (data, _) => {\n      callWebHook(client, req, 'messages.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('blocklist.update', (data, _) => {\n      callWebHook(client, req, 'messages.update', {\n        data: data,\n      });\n    });\n    sockect.ev.on('presence.update', (data, _) => {\n      callWebHook(client, req, 'presence.update', {\n        data: data,\n      });\n    });\n  }\n}\n"],"mappings":"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"}